<nav [ngClass]="menusmall ? 'menu-small' : ''" class="sidebar">
  <div [ngClass]="loader || loaderInit ? 'display-block' : ''" class="loader">Loading...</div>
  <div class="sidebar-sticky">
    <div class="navbar-brand-wrapper">
      <div class="navbar-brand col-auto">
        <app-logo [menuSmall]="menusmall" ></app-logo>
        <p class="logo-ver">{{'titles.versionPrefix' | translate}}{{(appInfo | async).version}}</p>
      </div>
      <a (click)="toggleMenu()" class="menu-hide">
        <svg id="i-caret-left" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="12" height="12" fill="none"
          stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
          <path d="M22 30 L6 16 22 2 Z" />
        </svg>
      </a>
    </div>

    <div class="d-flex justify-between align-items-center tool-panel">

      <form [formGroup]="searchForm" id="searchForm" class="nav-search w-100 flex-shrink-1" (submit)="getStreamsSearch()">
        <input class="form-control" placeholder="Search" type="text" id="search" name="search" formControlName="search"
          (keyup)="onChangeSearch(); getStreamsSearch()">

        <div class="input-group-append searchClear" [ngClass]="{'showClear': showClear}">
          <a (click)="onClearSearch()" tooltip="{{'buttons.clear' | translate}}" class="icon-text"
            id="headerSearchResultsClear">
            <svg fill="none" height="12" id="i-close" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round"
              stroke-width="2" viewBox="0 0 32 32" width="12" xmlns="http://www.w3.org/2000/svg">
              <path d="M2 30 L30 2 M30 30 L2 2" />
            </svg>
          </a>
        </div>
      </form>
      <button class="btn btn-sm btn-outline-primary streamsList-context-btn" type="button" (click)="onShowContextMenu($event)">
        <svg id="i-book" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none"
          stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1">
          <path d="M13,9.5h5v-2h-5V9.5z M13,16.5h5v-2h-5V16.5z M19,21H5c-1.1,0-2-0.9-2-2V5 c0-1.1,0.9-2,2-2h14c1.1,0,2,0.9,2,2v14C21,20.1,20.1,21,19,21z M6,11h5V6H6V11z M7,7h3v3H7V7z M6,18h5v-5H6V18z M7,14h3v3H7V14z" fill-rule="evenodd"/>
        </svg>
      </button>
    </div>
    <div class="streams-navigation">

      <perfect-scrollbar [config]="config" class="perf-scroll" (psScrollY)="onCloseContextMenu()">
        <ul *ngIf="(streamsState | async).streams as streams" class="nav flex-column">
          <li *ngFor="let stream of streams; trackBy: streamsTrack"
            [contextMenuSubject]="{stream: stream}" [contextMenu]="listMenu" class="side-nav-menu-item">
            <div class="side-nav-menu-link-wr">
              <a (dblclick)="getChilds($event, stream)"
                 appStreamsNavigationActive
                 [routerLink]="stream | streamsNavigationUrl: this.activeTabType: openInNewTab"
                 class="side-nav-menu-link media align-items-center">
                <span class="side-nav-fadeout-on-closed media-body menu-item-wrapper">
                  <span
                      [tooltip]="stream.name || stream.key"
                      [adaptivePosition]="false"
                      placement="top"
                      container="body"
                      [delay]="700"
                  >
                    {{ stream.name || stream.key }}
                  </span>
                  <span class="stream-symbols"> ({{stream.symbols}})</span>
                </span>
              </a>
              <ng-template #tolTemplate>
                <span *ngIf="!stream._shown">{{'buttons.open_symbols' | translate}}</span>
                <span *ngIf="stream._shown">{{'buttons.hide_symbols' | translate}}</span>
              </ng-template>
              <span (click)="getChilds($event, stream)" [adaptivePosition]="false" placement="top" container="body" [tooltip]="tolTemplate" *ngIf="stream.symbols || (streamsListOptionsForm.get('showSpaces').value && (!stream._symbolsList || stream._symbolsList.length))" class="arrow">
                <svg [ngClass]="{'rotated180': stream._shown}" fill="none" height="16" id="i-chevron-bottom"
                  stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  viewBox="0 0 32 32" width="16" xmlns="http://www.w3.org/2000/svg">
                  <path d="M30 12 L16 24 2 12" />
                </svg>
              </span>
            </div>

            <ng-template [ngIf]="stream._symbolsList && stream._symbolsList.length">
              <ul [ngClass]="{'collapse': !stream._shown}" class="nav flex-column">
                <li *ngFor="let symbol of stream._symbolsList; trackBy: symbolsTrack"
                  [contextMenuSubject]="{stream: stream, symbol: symbol}" [contextMenu]="listMenu"
                  class="side-nav-menu-item side-nav-menu-link-wr">
                  <a [routerLink]="stream | streamsNavigationUrl: this.activeTabType: openInNewTab: symbol"
                     appStreamsNavigationActive
                     class="side-nav-menu-link media align-items-center">
                    <span class="side-nav-fadeout-on-closed media-body">{{symbol}}</span>
                  </a>
                  <span class="arrow"></span>
                </li>
              </ul>
            </ng-template>

            <ng-template [ngIf]="stream._spacesList && stream._spacesList.length">
              <ul [ngClass]="{'collapse': !stream._shown}" class="nav flex-column">
                <li *ngFor="let space of stream._spacesList; trackBy: spacesTrack"
                  [contextMenuSubject]="{stream: stream, space: space}" [contextMenu]="listMenu" class="side-nav-menu-item">
                  <div class="side-nav-menu-link-wr">
                    <a (dblclick)="getChilds($event, stream, space)"
                       appStreamsNavigationActive
                       [routerLink]="stream | streamsNavigationUrl: this.activeTabType: openInNewTab"
                       [queryParams]="{space: space.name}"
                      class="side-nav-menu-link media align-items-center" routerLinkActive="active">
                      <span class="side-nav-fadeout-on-closed media-body">
                        <span [tooltip]="space.name" [adaptivePosition]="false" placement="top" container="body" [delay]="700">{{space.name || 'root'}} </span>
                      </span>
                    </a>
                    <ng-template #spaceTolTemplate>
                      <span *ngIf="!space._shown">{{'buttons.open_symbols' | translate}}</span>
                      <span *ngIf="space._shown">{{'buttons.hide_symbols' | translate}}</span>
                    </ng-template>
                    <span (click)="getChilds($event, stream, space)" [adaptivePosition]="false" placement="top" container="body" [tooltip]="spaceTolTemplate" *ngIf="stream.symbols && (streamsListOptionsForm.get('showSpaces').value && (!space._symbolsList || space._symbolsList.length))" class="arrow">
                      <svg [ngClass]="{'rotated180': space._shown}" fill="none" height="16" id="i-chevron-bottom"
                        stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        viewBox="0 0 32 32" width="16" xmlns="http://www.w3.org/2000/svg">
                        <path d="M30 12 L16 24 2 12" />
                      </svg>
                    </span>
                  </div>

                  <ul [ngClass]="{'collapse': !space._shown}" class="nav flex-column side-nav-menu-link">
                    <li *ngFor="let symbol of space._symbolsList; trackBy: symbolsTrack"
                      [contextMenuSubject]="{stream: stream, space: space, symbol: symbol}" [contextMenu]="listMenu"
                      class="side-nav-menu-item side-nav-menu-link-wr">
                      <a [routerLink]="stream | streamsNavigationUrl: this.activeTabType: openInNewTab: symbol"
                         appStreamsNavigationActive
                         [queryParams]="space.name ? {space: space.name} : null"
                        class="side-nav-menu-link media align-items-center">
                        <span class="side-nav-fadeout-on-closed media-body">{{symbol}}</span>
                      </a>
                      <span class="arrow"></span>
                    </li>
                  </ul>
                </li>
              </ul>
            </ng-template>


          </li>
        </ul>
        <ng-template [ngIf]="(streamsState | async).streams && !(streamsState | async).streams.length">
          <p class="d-flex w100 justify-content-center"><span>{{'text.streamsListEmpty' | translate}}</span></p>
        </ng-template>
        <ng-template [ngIf]="!(streamsState | async).streams && !loaderInit && !loader">
          <p class="d-flex w100 justify-content-center"><span>{{'text.streamsListEmpty' | translate}}</span></p>
        </ng-template>
      </perfect-scrollbar>
    </div>
  </div>
  <div class="nav-bottom">
    <form [formGroup]="streamsListOptionsForm" id="openNewTabForm">
      <div class="side-nav-menu-link-wr checkbox-link">
        <label class="container-ch"
          tooltip="{{'buttons.show_spaces' | translate}}">
          <span class="checkbox-label">{{'buttons.show_spaces' | translate}}</span>
          <input type="checkbox" id="showSpaces" name="showSpaces" formControlName="showSpaces"
            (change)="changeShowSpaces()">
          <span class="checkmark"></span>
        </label>
      </div>
      <div class="side-nav-menu-link-wr checkbox-link">
        <label class="container-ch"
          tooltip="{{'buttons.open_in_new_tab' | translate}}">
          <span class="checkbox-label">{{'buttons.open_in_new_tab' | translate}}</span>
          <input type="checkbox" id="openNewTab" name="openNewTab" formControlName="openNewTab"
            (change)="changeOpenNewTab()">
          <span class="checkmark"></span>
        </label>
      </div>
    </form>
    <button
      tooltip="{{'buttons.collapse_all' | translate}}"
      (click)="collapseAll()"
      class="btn btn-link collapse-all"
      type="button"
    >
      <svg id="i-archive" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="16" height="16" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
        <path d="M4 10 L4 28 28 28 28 10 M2 4 L2 10 30 10 30 4 Z M12 15 L20 15" />
      </svg>
    </button>
  </div>

</nav>

<context-menu #streamsMenu>
  <ng-template contextMenuItem passive="true">
    <button class="btn btn-link" (click)="onAskToCreateStream()">
      <svg id="i-book" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="16" height="16" fill="none"
        stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
        <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 14h-3v3h-2v-3H8v-2h3v-3h2v3h3v2zm-3-7V3.5L18.5 9H13z" />
      </svg>
      {{'contextMenu.create_stream' | translate}}
    </button>
  </ng-template>
  <ng-template contextMenuItem passive="true">
    <ng-container *ngTemplateOutlet="queryBtn" ></ng-container>
  </ng-template>
  <ng-template contextMenuItem passive="true">
    <button class="btn btn-link" (click)="onImportFromQMSG()">
      <svg xmlns="http://www.w3.org/2000/svg" height="16" viewBox="0 0 24 24" width="16" fill="currentColor">
        <path d="M0 0h24v24H0V0z" fill="none"/>
        <path d="M9 16h6v-6h4l-7-7-7 7h4v6zm3-10.17L14.17 8H13v6h-2V8H9.83L12 5.83zM5 18h14v2H5z"/>
      </svg>
      {{'contextMenu.importFromQMSG' | translate}}
    </button>
  </ng-template>

</context-menu>

<context-menu #listMenu>
  <ng-template contextMenuItem let-item passive="true">
    <a (click)="onCloseContextMenu()" tooltip="{{'tooltips.view_mode' | translate}}"
      [queryParams]="item && item.space ? {space: item.space.name} : {}"
      [routerLink]="item && item.symbol? ['symbol', 'view', item.stream.key, item.symbol] : ['stream', 'view', item.stream.key]">
      <svg id="i-book" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="16" height="16" fill="none"
        stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
        <path d="M16 7 C16 7 9 1 2 6 L2 28 C9 23 16 28 16 28 16 28 23 23 30 28 L30 6 C23 1 16 7 16 7 Z M16 7 L16 28" />
      </svg>
      {{'contextMenu.view_mode' | translate}}
    </a>
  </ng-template>
  <ng-template contextMenuItem let-item passive="true">
    <a (click)="onCloseContextMenu()" tooltip="{{'tooltips.reverse_mode' | translate}}"
      [queryParams]="item && item.space ? {space: item.space.name} : {}"
      [routerLink]="item && item.symbol? ['symbol', 'reverse', item.stream.key, item.symbol] : ['stream', 'reverse', item.stream.key]">
      <svg id="i-reply" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="16" height="16" fill="none"
        stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
        <path d="M10 6 L3 14 10 22 M3 14 L18 14 C26 14 30 18 30 26" />
      </svg>
      {{'contextMenu.reverse_mode' | translate}}
    </a>
  </ng-template>
  <ng-template contextMenuItem let-item passive="true">
    <a (click)="onCloseContextMenu()" tooltip="{{'tooltips.live_mode' | translate}}"
      [queryParams]="item && item.space ? {space: item.space.name} : {}"
      [routerLink]="item && item.symbol? ['symbol', 'live', item.stream.key, item.symbol] : ['stream', 'live', item.stream.key]">
      <svg id="i-clock-live" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" stroke="none"
        fill="currentcolor">
        <path d="M15.1,19.37l1,1.74c-0.96,0.44-2.01,0.73-3.1,0.84v-2.02C13.74,19.84,14.44,19.65,15.1,19.37z M4.07,13H2.05 c0.11,1.1,0.4,2.14,0.84,3.1l1.74-1C4.35,14.44,4.16,13.74,4.07,13z M15.1,4.63l1-1.74C15.14,2.45,14.1,2.16,13,2.05v2.02 C13.74,4.16,14.44,4.35,15.1,4.63z M19.93,11h2.02c-0.11-1.1-0.4-2.14-0.84-3.1l-1.74,1C19.65,9.56,19.84,10.26,19.93,11z M8.9,19.37l-1,1.74c0.96,0.44,2.01,0.73,3.1,0.84v-2.02C10.26,19.84,9.56,19.65,8.9,19.37z M11,4.07V2.05 c-1.1,0.11-2.14,0.4-3.1,0.84l1,1.74C9.56,4.35,10.26,4.16,11,4.07z M18.36,7.17l1.74-1.01c-0.63-0.87-1.4-1.64-2.27-2.27 l-1.01,1.74C17.41,6.08,17.92,6.59,18.36,7.17z M4.63,8.9l-1.74-1C2.45,8.86,2.16,9.9,2.05,11h2.02C4.16,10.26,4.35,9.56,4.63,8.9z M19.93,13c-0.09,0.74-0.28,1.44-0.56,2.1l1.74,1c0.44-0.96,0.73-2.01,0.84-3.1H19.93z M16.83,18.36l1.01,1.74 c0.87-0.63,1.64-1.4,2.27-2.27l-1.74-1.01C17.92,17.41,17.41,17.92,16.83,18.36z M7.17,5.64L6.17,3.89 C5.29,4.53,4.53,5.29,3.9,6.17l1.74,1.01C6.08,6.59,6.59,6.08,7.17,5.64z M5.64,16.83L3.9,17.83c0.63,0.87,1.4,1.64,2.27,2.27 l1.01-1.74C6.59,17.92,6.08,17.41,5.64,16.83z M13,7h-2v5.41l4.29,4.29l1.41-1.41L13,11.59V7z" />
      </svg>
      {{'contextMenu.live_mode' | translate}}
    </a>
  </ng-template>
  <ng-template contextMenuItem let-item passive="true">
    <a (click)="onCloseContextMenu()" tooltip="{{'tooltips.monitor_mode' | translate}}"
      [queryParams]="item && item.space ? {space: item.space.name} : {}"
      [routerLink]="item && item.symbol? ['symbol', 'monitor', item.stream.key, item.symbol] : ['stream', 'monitor', item.stream.key]">
      <svg id="i-clock" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="16" height="16" fill="none"
        stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
        <circle cx="16" cy="16" r="14" />
        <path d="M16 8 L16 16 20 20" />
      </svg>
      {{'contextMenu.monitor_mode' | translate}}
    </a>
  </ng-template>
  <ng-template contextMenuItem let-item passive="true">
    <a (click)="onCloseContextMenu()" tooltip="{{'buttons.schema_edit_mode' | translate}}" class="schema-view"
      [ngClass]="{'hidden': !(item && !item.symbol) || item.space}"
      [queryParams]="item && item.space ? {space: item.space.name} : {}"
      [routerLink]="['stream', 'schema-edit', item.stream.key]">
      <svg id="i-fullscreen-exit" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="16" height="16"
        fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
        <path d="M4 12 L12 12 12 4 M20 4 L20 12 28 12 M4 20 L12 20 12 28 M28 20 L20 20 20 28" />
        <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" />
      </svg>
      {{'buttons.schema_edit_mode' | translate}}
    </a>
  </ng-template>

  <ng-template contextMenuItem let-item passive="true">
    <ng-container *ngTemplateOutlet="queryBtn" ></ng-container>
  </ng-template>

  <ng-template #queryBtn >
    <a (click)="onCloseContextMenu()" [tooltip]="'tooltips.query_mode' | translate"
       [routerLink]="['query']">
      <svg id="i-msg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="16" height="16" fill="none"
           stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
        <path d="M2 4 L30 4 30 22 16 22 8 29 8 22 2 22 Z" />
      </svg>
      {{'contextMenu.query' | translate}}
    </a>
  </ng-template>


  <ng-template contextMenuItem let-item passive="true">
    <span class="menu-separator"
      [ngClass]="{'hidden': checkRootSpace(item.space)}"></span>
  </ng-template>

  <ng-template contextMenuItem let-item passive="true">
    <button type="button" (click)="onShowTruncateModal(item)" tooltip="{{'tooltips.truncate' | translate}}" class="btn btn-link schema-view"
      [ngClass]="{'hidden': !(item && !item.symbol) || item.space}">
      <svg id="i-fullscreen-exit" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="16" height="16"
        fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1">
        <path d="M9.64 7.64c.23-.5.36-1.05.36-1.64 0-2.21-1.79-4-4-4S2 3.79 2 6s1.79 4 4 4c.59 0 1.14-.13 1.64-.36L10 12l-2.36 2.36C7.14 14.13 6.59 14 6 14c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4c0-.59-.13-1.14-.36-1.64L12 14l7 7h3v-1L9.64 7.64zM6 8c-1.1 0-2-.89-2-2s.9-2 2-2 2 .89 2 2-.9 2-2 2zm0 12c-1.1 0-2-.89-2-2s.9-2 2-2 2 .89 2 2-.9 2-2 2zm6-7.5c-.28 0-.5-.22-.5-.5s.22-.5.5-.5.5.22.5.5-.22.5-.5.5zM19 3l-6 6 2 2 7-7V3z" />
      </svg>
      {{'contextMenu.truncate' | translate}}
    </button>
  </ng-template>
  <ng-template contextMenuItem let-item passive="true">
    <button type="button" (click)="onShowPurgeModal(item)" tooltip="{{'tooltips.purge' | translate}}" class="btn btn-link schema-view"
      [ngClass]="{'hidden': !(item && !item.symbol) || item.space}">
      <svg id="i-fullscreen-exit" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="16" height="16"
        fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
        <path d="M19.81 14.99l1.19-.92-1.43-1.43-1.19.92 1.43 1.43zm-.45-4.72L21 9l-9-7-2.91 2.27 7.87 7.88 2.4-1.88zM3.27 1L2 2.27l4.22 4.22L3 9l1.63 1.27L12 16l2.1-1.63 1.43 1.43L12 18.54l-7.37-5.73L3 14.07l9 7 4.95-3.85L20.73 21 22 19.73 3.27 1z" />
      </svg>
      {{'contextMenu.purge' | translate}}
    </button>
  </ng-template>
  <ng-template contextMenuItem let-item passive="true">
    <button type="button" (click)="onAskToDeleteStream(item)" tooltip="{{(item.space ? 'tooltips.deleteSpace' : 'tooltips.deleteStream')  | translate}}" class="btn btn-link schema-view"
      [ngClass]="{'hidden': !(item && !item.symbol) || checkRootSpace(item.space)}">
      <svg id="i-fullscreen-exit" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="16" height="16"
        fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
        <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" />
      </svg>
      {{(item.space ? 'tooltips.deleteSpace' : 'tooltips.deleteStream') | translate}}
    </button>
  </ng-template>
  <ng-template contextMenuItem let-item passive="true">
    <button type="button" (click)="onShowEditNameModal(item)" tooltip="{{'tooltips.editName' | translate}}" class="btn btn-link schema-view"
      [ngClass]="{'hidden': checkRootSpace(item.space)}">
      <svg id="i-fullscreen-exit" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="16" height="16"
        fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
        <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" />
      </svg>
      {{'contextMenu.editName' | translate}}
    </button>
  </ng-template>
  <ng-template contextMenuItem let-item passive="true">
    <button type="button" (click)="onShowDescribe(item)" tooltip="{{'tooltips.describe' | translate}}" class="btn btn-link schema-view"
      [ngClass]="{'hidden': !(item && !item.symbol) || item.space}">
      <svg id="i-fullscreen-exit" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="16" height="16"
        fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
        <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" />
      </svg>
      {{'contextMenu.describe' | translate}}
    </button>
  </ng-template>
  <ng-template contextMenuItem let-item passive="true">
    <button type="button" (click)="onShowSendMessage(item)" tooltip="{{'tooltips.sendMessage' | translate}}" class="btn btn-link schema-view"
      [ngClass]="{'hidden': !(item && !item.symbol) || item.space}">
      <svg id="i-fullscreen-exit" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="16" height="16"
        fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
        <path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z" />
      </svg>
      {{'contextMenu.sendMessage' | translate}}
    </button>
  </ng-template>

  <ng-template contextMenuItem let-item passive="true">
    <span class="menu-separator" [ngClass]="{'schema-view hidden': !(item && !item.symbol) || item.space}"></span>
  </ng-template>

  <ng-template contextMenuItem let-item passive="true">
    <button
      type="button"
      (click)="onExportQSMSGFile(item)"
      [tooltip]="'tooltips.export_toQSMSG_file' | translate"
      class="btn btn-link schema-view"
      [class.hidden]="!(item && !item.symbol) || item.space"
    >
      <ng-container *ngTemplateOutlet="downloadIcon" ></ng-container>
      {{'contextMenu.export_toQSMSG_file' | translate}}
    </button>
  </ng-template>
  <ng-template contextMenuItem let-item passive="true">
    <button type="button"
            (click)="onExportCsv(item.stream)"
            [tooltip]="'tooltips.export_toCSV' | translate"
            class="btn btn-link"
            [class.hidden]="item.symbol || item.space"
    >
      <ng-container *ngTemplateOutlet="downloadIcon" ></ng-container>
      {{'contextMenu.export_toCSV' | translate}}
    </button>
  </ng-template>
</context-menu>

<ng-template #downloadIcon >
  <svg
    id="i-fullscreen-exit"
    xmlns="http://www.w3.org/2000/svg"
    viewBox="0 0 32 32"
    width="16"
    height="16"
    fill="none"
    stroke="currentcolor"
    stroke-linecap="round"
    stroke-linejoin="round"
    stroke-width="2"
  >
    <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z" />
  </svg>
</ng-template>

<ng-template #modalTemplate>
  <!--  <div class="modal-header">-->
  <!--    <h4 class="modal-title pull-left">{{'sectionTitles.action_confirmation' | translate}}</h4>-->
  <!--  </div>-->
  <div class="modal-body">
    {{(deleteModalData.space ? 'text.deleteSpaceRequest' : 'text.deleteStreamRequest') | translate}}
    <span class="text-danger">{{deleteModalData.space ? deleteModalData.space.name : deleteModalData.stream.key}}</span> ?
  </div>
  <div class="modal-footer d-flex justify-content-end">
    <button type="button" class="btn btn-danger pull-right" aria-label="Close" (click)="onDeleteStream(deleteModalData)">
      <span aria-hidden="true">{{'buttons.delete' | translate}}</span>
    </button>
    <button type="button" class="btn btn-outline-light pull-right" aria-label="Close" (click)="deleteModalRef.hide()">
      <span aria-hidden="true">{{'buttons.cancel' | translate}}</span>
    </button>
  </div>
</ng-template>

<ng-template #createStreamModalTemplate>
  <div class="modal-header">
    <h4 class="modal-title pull-left">{{'text.onCreateStream' | translate}}</h4>
  </div>
  <div class="modal-body">
    <form [formGroup]="createStreamForm" id="nameForm" (ngSubmit)="onCreateStream()">
      <div class="controlWr">
        <label class="btn control-label" for="keyInput">
          {{'forms.enterKey' | translate}}
        </label>
        <input class="btn input-control"
          type="text"
          id="keyInput"
          name="key"
          formControlName="key"
        />
      </div>
      <div *ngIf="ifCreateStreamFormError()"
        class="alert alert-danger my-1 p-2 fadeInDown animated validation-error">
        <span class="d-block" *ngIf="createStreamForm.get('key').getError('required')">
          {{'forms.validators.requiredField' | translate}}
        </span>
        <span class="d-block" *ngIf="ifCreateStreamFormKeyForbidden()">
          {{'forms.validators.streamNameExists' | translate}}
        </span>
      </div>
    </form>
  </div>
  <div class="modal-footer d-flex justify-content-end">
    <button [disabled]="createStreamForm.invalid || createStreamForm.pristine" type="submit" form="nameForm" class="btn btn-danger pull-right" aria-label="Close" >
      <span aria-hidden="true">{{'buttons.start_creating' | translate}}</span>
    </button>
    <button type="button" class="btn btn-outline-light pull-right" aria-label="Close" (click)="createStreamModalRef.hide()">
      <span aria-hidden="true">{{'buttons.cancel' | translate}}</span>
    </button>
  </div>
</ng-template>
